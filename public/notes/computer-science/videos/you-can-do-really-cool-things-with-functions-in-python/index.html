<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Modified: July 15 2024
Link to video.
This video goes over some uncommon ways to use functions in Python. It uses the following code as a base:
&#34;&#34;&#34; main.py &#34;&#34;&#34; import statistics from dataclasses import dataclass from typing import Protocol from exchange import Exchange class TradingStrategy(Protocol): &#34;&#34;&#34;Trading strategy that decides whether to buy or sell, given a list of prices&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: raise NotImplementedError() def should_sell(self, prices: list[int]) -&gt; bool: raise NotImplementedError() class AverageTradingStrategy: &#34;&#34;&#34;Trading strategy based on price averages.&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: list_window = prices[-3:] return prices[-1] &lt; statistics.mean(list_window) def should_sell(self, prices: list[int]) -&gt; bool: list_window = prices[-3:] return prices[-1] &gt; statistics.mean(list_window) class MinMaxTradingStrategy: &#34;&#34;&#34;Trading strategy based on price minima and maxima.&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: # buy if it&#39;s below $32,000 return prices[-1] &lt; 32_000_00 def should_sell(self, prices: list[int]) -&gt; bool: # sell if it&#39;s above $33,000 return prices[-1] &gt; 33_000_00 @dataclass class TradingBot: &#34;&#34;&#34;Trading bot that connects to a crypto exchange and performs trades.&#34;&#34;&#34; exchange: Exchange trading_strategy: TradingStrategy def run(self, symbol: str) -&gt; None: prices = self.exchange.get_market_data(symbol) should_buy = self.trading_strategy.should_buy(prices) should_sell = self.trading_strategy.should_sell(prices) if should_buy: self.exchange.buy(symbol, 10) elif should_sell: self.exchange.sell(symbol, 10) else: print(f&#39;No action required for {symbol}.&#39;) def main() -&gt; None: # Creates the exchange and connects to it exchange = Exchange() exchange.connect() # create the trading strategy trading_strategy = AverageTradingStrategy() # create the trading bot and run the bot once bot = TradingBot(exchange, trading_strategy) bot.run(&#39;BTC/USD&#39;) if __name__ == &#39;__main__&#39;: main() &#34;&#34;&#34; exchange.py &#34;&#34;&#34; PRICE_DATA = { &#34;BTC/USD&#34;: [ 35_842_00, 34_069_00, 33_871_00, 34_209_00, 32_917_00, 33_931_00, 33_370_00, 34_445_00, 32_901_00, 33_013_00, ], &#34;ETH/USD&#34;: [ 2_381_00, 2_233_00, 2_300_00, 2_342_00, 2_137_00, 2_156_00, 2_103_00, 2_165_00, 2_028_00, 2_004_00, ], } class ExchangeConnectionError(Exception): &#34;&#34;&#34;Custom error that is raised when an exchange connection fails.&#34;&#34;&#34; class Exchange: def __init__(self) -&gt; None: self.connected = False def connect(self) -&gt; None: &#34;&#34;&#34;Connects to the exchange.&#34;&#34;&#34; print(&#34;Connecting to Crypto Bullshit...&#34;) self.connected = True def check_connection(self) -&gt; None: &#34;&#34;&#34;Checks if the exchange is connected.&#34;&#34;&#34; if not self.connected: raise ExchangeConnectionError(&#34;Exchange is not connected dummy.&#34;) def get_market_data(self, symbol: str) -&gt; list[int]: &#34;&#34;&#34;Returns fake market price for data given a market symbol.&#34;&#34;&#34; self.check_connection() return PRICE_DATA[symbol] def buy(self, symbol: str, amount: int) -&gt; None: &#34;&#34;&#34;Simulate buying an amount of a given symbol at current price.&#34;&#34;&#34; self.check_connection() print(f&#39;Buying amount {amount} in market {symbol}.&#39;) def sell(self, symbol: str, amount: int) -&gt; None: &#34;&#34;&#34;Simulate selling an amount of a given symbol at current price.&#34;&#34;&#34; self.check_connection() print(f&#39;Selling amount {amount} in market {symbol}.&#39;) Functions can replicate or even replace code that is heavily reliant on classes. As we see in the code above, the structure is built off of a base TradingStrategy() class, and is used/reference many times.
" />
<meta name="keywords" content="homepage, blog, computerscience, youtube, python" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://mrpointing.com/notes/computer-science/videos/you-can-do-really-cool-things-with-functions-in-python/" />


    <title>
        
            You Can Do Really Cool Things With Functions in Python :: Mr. Pointing  â€” Computer Science Teacher
        
    </title>





<link rel="stylesheet" href="/main.7f0f0e09d855bb3e994e0822978b2b19010d62b45a960878c88ba8b8d6808eb2.css" integrity="sha256-fw8OCdhVuz6ZTggil4srGQENYrRalgh4yIuouNaAjrI=">




<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="You Can Do Really Cool Things With Functions in Python">
  <meta itemprop="description" content="Modified: July 15 2024
Link to video.
This video goes over some uncommon ways to use functions in Python. It uses the following code as a base:
&#34;&#34;&#34; main.py &#34;&#34;&#34; import statistics from dataclasses import dataclass from typing import Protocol from exchange import Exchange class TradingStrategy(Protocol): &#34;&#34;&#34;Trading strategy that decides whether to buy or sell, given a list of prices&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: raise NotImplementedError() def should_sell(self, prices: list[int]) -&gt; bool: raise NotImplementedError() class AverageTradingStrategy: &#34;&#34;&#34;Trading strategy based on price averages.&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: list_window = prices[-3:] return prices[-1] &lt; statistics.mean(list_window) def should_sell(self, prices: list[int]) -&gt; bool: list_window = prices[-3:] return prices[-1] &gt; statistics.mean(list_window) class MinMaxTradingStrategy: &#34;&#34;&#34;Trading strategy based on price minima and maxima.&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: # buy if it&#39;s below $32,000 return prices[-1] &lt; 32_000_00 def should_sell(self, prices: list[int]) -&gt; bool: # sell if it&#39;s above $33,000 return prices[-1] &gt; 33_000_00 @dataclass class TradingBot: &#34;&#34;&#34;Trading bot that connects to a crypto exchange and performs trades.&#34;&#34;&#34; exchange: Exchange trading_strategy: TradingStrategy def run(self, symbol: str) -&gt; None: prices = self.exchange.get_market_data(symbol) should_buy = self.trading_strategy.should_buy(prices) should_sell = self.trading_strategy.should_sell(prices) if should_buy: self.exchange.buy(symbol, 10) elif should_sell: self.exchange.sell(symbol, 10) else: print(f&#39;No action required for {symbol}.&#39;) def main() -&gt; None: # Creates the exchange and connects to it exchange = Exchange() exchange.connect() # create the trading strategy trading_strategy = AverageTradingStrategy() # create the trading bot and run the bot once bot = TradingBot(exchange, trading_strategy) bot.run(&#39;BTC/USD&#39;) if __name__ == &#39;__main__&#39;: main() &#34;&#34;&#34; exchange.py &#34;&#34;&#34; PRICE_DATA = { &#34;BTC/USD&#34;: [ 35_842_00, 34_069_00, 33_871_00, 34_209_00, 32_917_00, 33_931_00, 33_370_00, 34_445_00, 32_901_00, 33_013_00, ], &#34;ETH/USD&#34;: [ 2_381_00, 2_233_00, 2_300_00, 2_342_00, 2_137_00, 2_156_00, 2_103_00, 2_165_00, 2_028_00, 2_004_00, ], } class ExchangeConnectionError(Exception): &#34;&#34;&#34;Custom error that is raised when an exchange connection fails.&#34;&#34;&#34; class Exchange: def __init__(self) -&gt; None: self.connected = False def connect(self) -&gt; None: &#34;&#34;&#34;Connects to the exchange.&#34;&#34;&#34; print(&#34;Connecting to Crypto Bullshit...&#34;) self.connected = True def check_connection(self) -&gt; None: &#34;&#34;&#34;Checks if the exchange is connected.&#34;&#34;&#34; if not self.connected: raise ExchangeConnectionError(&#34;Exchange is not connected dummy.&#34;) def get_market_data(self, symbol: str) -&gt; list[int]: &#34;&#34;&#34;Returns fake market price for data given a market symbol.&#34;&#34;&#34; self.check_connection() return PRICE_DATA[symbol] def buy(self, symbol: str, amount: int) -&gt; None: &#34;&#34;&#34;Simulate buying an amount of a given symbol at current price.&#34;&#34;&#34; self.check_connection() print(f&#39;Buying amount {amount} in market {symbol}.&#39;) def sell(self, symbol: str, amount: int) -&gt; None: &#34;&#34;&#34;Simulate selling an amount of a given symbol at current price.&#34;&#34;&#34; self.check_connection() print(f&#39;Selling amount {amount} in market {symbol}.&#39;) Functions can replicate or even replace code that is heavily reliant on classes. As we see in the code above, the structure is built off of a base TradingStrategy() class, and is used/reference many times.">
  <meta itemprop="datePublished" content="2024-07-15T00:00:00+00:00">
  <meta itemprop="dateModified" content="2024-07-15T00:00:00+00:00">
  <meta itemprop="wordCount" content="1014">
  <meta itemprop="image" content="https://mrpointing.com/">
  <meta itemprop="keywords" content="Computerscience,Youtube,Python">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://mrpointing.com/">
  <meta name="twitter:title" content="You Can Do Really Cool Things With Functions in Python">
  <meta name="twitter:description" content="Modified: July 15 2024
Link to video.
This video goes over some uncommon ways to use functions in Python. It uses the following code as a base:
&#34;&#34;&#34; main.py &#34;&#34;&#34; import statistics from dataclasses import dataclass from typing import Protocol from exchange import Exchange class TradingStrategy(Protocol): &#34;&#34;&#34;Trading strategy that decides whether to buy or sell, given a list of prices&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: raise NotImplementedError() def should_sell(self, prices: list[int]) -&gt; bool: raise NotImplementedError() class AverageTradingStrategy: &#34;&#34;&#34;Trading strategy based on price averages.&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: list_window = prices[-3:] return prices[-1] &lt; statistics.mean(list_window) def should_sell(self, prices: list[int]) -&gt; bool: list_window = prices[-3:] return prices[-1] &gt; statistics.mean(list_window) class MinMaxTradingStrategy: &#34;&#34;&#34;Trading strategy based on price minima and maxima.&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: # buy if it&#39;s below $32,000 return prices[-1] &lt; 32_000_00 def should_sell(self, prices: list[int]) -&gt; bool: # sell if it&#39;s above $33,000 return prices[-1] &gt; 33_000_00 @dataclass class TradingBot: &#34;&#34;&#34;Trading bot that connects to a crypto exchange and performs trades.&#34;&#34;&#34; exchange: Exchange trading_strategy: TradingStrategy def run(self, symbol: str) -&gt; None: prices = self.exchange.get_market_data(symbol) should_buy = self.trading_strategy.should_buy(prices) should_sell = self.trading_strategy.should_sell(prices) if should_buy: self.exchange.buy(symbol, 10) elif should_sell: self.exchange.sell(symbol, 10) else: print(f&#39;No action required for {symbol}.&#39;) def main() -&gt; None: # Creates the exchange and connects to it exchange = Exchange() exchange.connect() # create the trading strategy trading_strategy = AverageTradingStrategy() # create the trading bot and run the bot once bot = TradingBot(exchange, trading_strategy) bot.run(&#39;BTC/USD&#39;) if __name__ == &#39;__main__&#39;: main() &#34;&#34;&#34; exchange.py &#34;&#34;&#34; PRICE_DATA = { &#34;BTC/USD&#34;: [ 35_842_00, 34_069_00, 33_871_00, 34_209_00, 32_917_00, 33_931_00, 33_370_00, 34_445_00, 32_901_00, 33_013_00, ], &#34;ETH/USD&#34;: [ 2_381_00, 2_233_00, 2_300_00, 2_342_00, 2_137_00, 2_156_00, 2_103_00, 2_165_00, 2_028_00, 2_004_00, ], } class ExchangeConnectionError(Exception): &#34;&#34;&#34;Custom error that is raised when an exchange connection fails.&#34;&#34;&#34; class Exchange: def __init__(self) -&gt; None: self.connected = False def connect(self) -&gt; None: &#34;&#34;&#34;Connects to the exchange.&#34;&#34;&#34; print(&#34;Connecting to Crypto Bullshit...&#34;) self.connected = True def check_connection(self) -&gt; None: &#34;&#34;&#34;Checks if the exchange is connected.&#34;&#34;&#34; if not self.connected: raise ExchangeConnectionError(&#34;Exchange is not connected dummy.&#34;) def get_market_data(self, symbol: str) -&gt; list[int]: &#34;&#34;&#34;Returns fake market price for data given a market symbol.&#34;&#34;&#34; self.check_connection() return PRICE_DATA[symbol] def buy(self, symbol: str, amount: int) -&gt; None: &#34;&#34;&#34;Simulate buying an amount of a given symbol at current price.&#34;&#34;&#34; self.check_connection() print(f&#39;Buying amount {amount} in market {symbol}.&#39;) def sell(self, symbol: str, amount: int) -&gt; None: &#34;&#34;&#34;Simulate selling an amount of a given symbol at current price.&#34;&#34;&#34; self.check_connection() print(f&#39;Selling amount {amount} in market {symbol}.&#39;) Functions can replicate or even replace code that is heavily reliant on classes. As we see in the code above, the structure is built off of a base TradingStrategy() class, and is used/reference many times.">



    <meta property="og:url" content="https://mrpointing.com/notes/computer-science/videos/you-can-do-really-cool-things-with-functions-in-python/">
  <meta property="og:site_name" content="Mr. Pointing">
  <meta property="og:title" content="You Can Do Really Cool Things With Functions in Python">
  <meta property="og:description" content="Modified: July 15 2024
Link to video.
This video goes over some uncommon ways to use functions in Python. It uses the following code as a base:
&#34;&#34;&#34; main.py &#34;&#34;&#34; import statistics from dataclasses import dataclass from typing import Protocol from exchange import Exchange class TradingStrategy(Protocol): &#34;&#34;&#34;Trading strategy that decides whether to buy or sell, given a list of prices&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: raise NotImplementedError() def should_sell(self, prices: list[int]) -&gt; bool: raise NotImplementedError() class AverageTradingStrategy: &#34;&#34;&#34;Trading strategy based on price averages.&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: list_window = prices[-3:] return prices[-1] &lt; statistics.mean(list_window) def should_sell(self, prices: list[int]) -&gt; bool: list_window = prices[-3:] return prices[-1] &gt; statistics.mean(list_window) class MinMaxTradingStrategy: &#34;&#34;&#34;Trading strategy based on price minima and maxima.&#34;&#34;&#34; def should_buy(self, prices: list[int]) -&gt; bool: # buy if it&#39;s below $32,000 return prices[-1] &lt; 32_000_00 def should_sell(self, prices: list[int]) -&gt; bool: # sell if it&#39;s above $33,000 return prices[-1] &gt; 33_000_00 @dataclass class TradingBot: &#34;&#34;&#34;Trading bot that connects to a crypto exchange and performs trades.&#34;&#34;&#34; exchange: Exchange trading_strategy: TradingStrategy def run(self, symbol: str) -&gt; None: prices = self.exchange.get_market_data(symbol) should_buy = self.trading_strategy.should_buy(prices) should_sell = self.trading_strategy.should_sell(prices) if should_buy: self.exchange.buy(symbol, 10) elif should_sell: self.exchange.sell(symbol, 10) else: print(f&#39;No action required for {symbol}.&#39;) def main() -&gt; None: # Creates the exchange and connects to it exchange = Exchange() exchange.connect() # create the trading strategy trading_strategy = AverageTradingStrategy() # create the trading bot and run the bot once bot = TradingBot(exchange, trading_strategy) bot.run(&#39;BTC/USD&#39;) if __name__ == &#39;__main__&#39;: main() &#34;&#34;&#34; exchange.py &#34;&#34;&#34; PRICE_DATA = { &#34;BTC/USD&#34;: [ 35_842_00, 34_069_00, 33_871_00, 34_209_00, 32_917_00, 33_931_00, 33_370_00, 34_445_00, 32_901_00, 33_013_00, ], &#34;ETH/USD&#34;: [ 2_381_00, 2_233_00, 2_300_00, 2_342_00, 2_137_00, 2_156_00, 2_103_00, 2_165_00, 2_028_00, 2_004_00, ], } class ExchangeConnectionError(Exception): &#34;&#34;&#34;Custom error that is raised when an exchange connection fails.&#34;&#34;&#34; class Exchange: def __init__(self) -&gt; None: self.connected = False def connect(self) -&gt; None: &#34;&#34;&#34;Connects to the exchange.&#34;&#34;&#34; print(&#34;Connecting to Crypto Bullshit...&#34;) self.connected = True def check_connection(self) -&gt; None: &#34;&#34;&#34;Checks if the exchange is connected.&#34;&#34;&#34; if not self.connected: raise ExchangeConnectionError(&#34;Exchange is not connected dummy.&#34;) def get_market_data(self, symbol: str) -&gt; list[int]: &#34;&#34;&#34;Returns fake market price for data given a market symbol.&#34;&#34;&#34; self.check_connection() return PRICE_DATA[symbol] def buy(self, symbol: str, amount: int) -&gt; None: &#34;&#34;&#34;Simulate buying an amount of a given symbol at current price.&#34;&#34;&#34; self.check_connection() print(f&#39;Buying amount {amount} in market {symbol}.&#39;) def sell(self, symbol: str, amount: int) -&gt; None: &#34;&#34;&#34;Simulate selling an amount of a given symbol at current price.&#34;&#34;&#34; self.check_connection() print(f&#39;Selling amount {amount} in market {symbol}.&#39;) Functions can replicate or even replace code that is heavily reliant on classes. As we see in the code above, the structure is built off of a base TradingStrategy() class, and is used/reference many times.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="notes">
    <meta property="article:published_time" content="2024-07-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2024-07-15T00:00:00+00:00">
    <meta property="article:tag" content="Computerscience">
    <meta property="article:tag" content="Youtube">
    <meta property="article:tag" content="Python">
    <meta property="og:image" content="https://mrpointing.com/">






    <meta property="article:published_time" content="2024-07-15 00:00:00 &#43;0000 UTC" />









    




    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">

    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                mr. pointing</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">About</a></li><li><a href="/notes">Notes</a></li><li><a href="/now">Now</a></li><li><a href="/posts">Posts</a></li><li><a href="/projects">Projects</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://mrpointing.com/notes/computer-science/videos/you-can-do-really-cool-things-with-functions-in-python/">You Can Do Really Cool Things With Functions in Python</a></h2>

            
            
            

            <div class="post-content">
                <p>Modified: July 15 2024</p>
<p><a href="https://www.youtube.com/watch?v=ph2HjBQuI8Y&list=PLU-P2PlzpIf3EpWfxk-Mu_ZVJVS5Wb-_e&index=35">Link</a> to video.</p>
<hr>
<p>This video goes over some uncommon ways to use functions in Python. It uses the following code as a base:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">main.py 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> statistics  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dataclasses <span style="color:#f92672">import</span> dataclass  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Protocol  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> exchange <span style="color:#f92672">import</span> Exchange  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TradingStrategy</span>(Protocol):  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Trading strategy that decides whether to buy or sell, given a list of prices&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_buy</span>(self, prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">NotImplementedError</span>()  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_sell</span>(self, prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">raise</span> <span style="color:#a6e22e">NotImplementedError</span>()  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AverageTradingStrategy</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Trading strategy based on price averages.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_buy</span>(self, prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>        list_window <span style="color:#f92672">=</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>:]  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span> statistics<span style="color:#f92672">.</span>mean(list_window)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_sell</span>(self, prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>        list_window <span style="color:#f92672">=</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>:]  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&gt;</span> statistics<span style="color:#f92672">.</span>mean(list_window)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MinMaxTradingStrategy</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Trading strategy based on price minima and maxima.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_buy</span>(self, prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># buy if it&#39;s below $32,000  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32_000_00</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_sell</span>(self, prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># sell if it&#39;s above $33,000  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">33_000_00</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TradingBot</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Trading bot that connects to a crypto exchange and performs trades.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    exchange: Exchange  
</span></span><span style="display:flex;"><span>    trading_strategy: TradingStrategy  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self, symbol: str) <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>        prices <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>exchange<span style="color:#f92672">.</span>get_market_data(symbol)  
</span></span><span style="display:flex;"><span>        should_buy <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>trading_strategy<span style="color:#f92672">.</span>should_buy(prices)  
</span></span><span style="display:flex;"><span>        should_sell <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>trading_strategy<span style="color:#f92672">.</span>should_sell(prices)  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> should_buy:  
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>exchange<span style="color:#f92672">.</span>buy(symbol, <span style="color:#ae81ff">10</span>)  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> should_sell:  
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>exchange<span style="color:#f92672">.</span>sell(symbol, <span style="color:#ae81ff">10</span>)  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:  
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;No action required for </span><span style="color:#e6db74">{</span>symbol<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#39;</span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>() <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Creates the exchange and connects to it  </span>
</span></span><span style="display:flex;"><span>    exchange <span style="color:#f92672">=</span> Exchange()  
</span></span><span style="display:flex;"><span>    exchange<span style="color:#f92672">.</span>connect()  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># create the trading strategy  </span>
</span></span><span style="display:flex;"><span>    trading_strategy <span style="color:#f92672">=</span> AverageTradingStrategy()  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># create the trading bot and run the bot once  </span>
</span></span><span style="display:flex;"><span>    bot <span style="color:#f92672">=</span> TradingBot(exchange, trading_strategy)  
</span></span><span style="display:flex;"><span>    bot<span style="color:#f92672">.</span>run(<span style="color:#e6db74">&#39;BTC/USD&#39;</span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:  
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">exchange.py
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>PRICE_DATA <span style="color:#f92672">=</span> {  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;BTC/USD&#34;</span>: [  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">35_842_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">34_069_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">33_871_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">34_209_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">32_917_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">33_931_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">33_370_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">34_445_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">32_901_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">33_013_00</span>,  
</span></span><span style="display:flex;"><span>    ],  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;ETH/USD&#34;</span>: [  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_381_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_233_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_300_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_342_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_137_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_156_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_103_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_165_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_028_00</span>,  
</span></span><span style="display:flex;"><span>        <span style="color:#ae81ff">2_004_00</span>,  
</span></span><span style="display:flex;"><span>    ],  
</span></span><span style="display:flex;"><span>}  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ExchangeConnectionError</span>(<span style="color:#a6e22e">Exception</span>):  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Custom error that is raised when an exchange connection fails.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Exchange</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self) <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>connected <span style="color:#f92672">=</span> <span style="color:#66d9ef">False</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">connect</span>(self) <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Connects to the exchange.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Connecting to Crypto Bullshit...&#34;</span>)  
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>connected <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_connection</span>(self) <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Checks if the exchange is connected.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> self<span style="color:#f92672">.</span>connected:  
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> ExchangeConnectionError(<span style="color:#e6db74">&#34;Exchange is not connected dummy.&#34;</span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_market_data</span>(self, symbol: str) <span style="color:#f92672">-&gt;</span> list[int]:  
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Returns fake market price for data given a market symbol.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>check_connection()  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> PRICE_DATA[symbol]  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">buy</span>(self, symbol: str, amount: int) <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Simulate buying an amount of a given symbol at current price.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>check_connection()  
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Buying amount </span><span style="color:#e6db74">{</span>amount<span style="color:#e6db74">}</span><span style="color:#e6db74"> in market </span><span style="color:#e6db74">{</span>symbol<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#39;</span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">sell</span>(self, symbol: str, amount: int) <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;&#34;&#34;Simulate selling an amount of a given symbol at current price.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>check_connection()  
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Selling amount </span><span style="color:#e6db74">{</span>amount<span style="color:#e6db74">}</span><span style="color:#e6db74"> in market </span><span style="color:#e6db74">{</span>symbol<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#39;</span>)
</span></span></code></pre></div><p>Functions can replicate or even replace code that is heavily reliant on classes. As we see in the code above, the structure is built off of a base <code>TradingStrategy()</code> class, and is used/reference many times.</p>
<p>We can rebuild the previous example like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">main.py with functions instead of classes 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> statistics  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dataclasses <span style="color:#f92672">import</span> dataclass  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Callable, Protocol  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> exchange <span style="color:#f92672">import</span> Exchange  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>TradingStrategyFunction <span style="color:#f92672">=</span> Callable[list[int], bool]  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_buy_avg</span>(prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>    list_window <span style="color:#f92672">=</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>:]  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span> statistics<span style="color:#f92672">.</span>mean(list_window)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_sell_avg</span>(prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>    list_window <span style="color:#f92672">=</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>:]  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&gt;</span> statistics<span style="color:#f92672">.</span>mean(list_window)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_buy_minmax</span>(prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># buy if it&#39;s below $32,000  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32_000_00</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_sell_minmax</span>(prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># sell if it&#39;s above $33,000  </span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">33_000_00</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TradingBot</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Trading bot that connects to a crypto exchange and performs trades.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    exchange: Exchange  
</span></span><span style="display:flex;"><span>    buy_strategy: TradingStrategyFunction  
</span></span><span style="display:flex;"><span>    sell_strategy: TradingStrategyFunction  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self, symbol: str) <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>        prices <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>exchange<span style="color:#f92672">.</span>get_market_data(symbol)  
</span></span><span style="display:flex;"><span>        should_buy <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>buy_strategy(prices)  
</span></span><span style="display:flex;"><span>        should_sell <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>sell_strategy(prices)  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> should_buy:  
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>exchange<span style="color:#f92672">.</span>buy(symbol, <span style="color:#ae81ff">10</span>)  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> should_sell:  
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>exchange<span style="color:#f92672">.</span>sell(symbol, <span style="color:#ae81ff">10</span>)  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:  
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;No action required for </span><span style="color:#e6db74">{</span>symbol<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#39;</span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>() <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Creates the exchange and connects to it  </span>
</span></span><span style="display:flex;"><span>    exchange <span style="color:#f92672">=</span> Exchange()  
</span></span><span style="display:flex;"><span>    exchange<span style="color:#f92672">.</span>connect()  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># create the trading bot and run the bot once  </span>
</span></span><span style="display:flex;"><span>    bot <span style="color:#f92672">=</span> TradingBot(exchange, should_buy_avg, should_sell_avg)  
</span></span><span style="display:flex;"><span>    bot<span style="color:#f92672">.</span>run(<span style="color:#e6db74">&#39;BTC/USD&#39;</span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:  
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><p>However, since we aren&rsquo;t using classes, passing parameters to things like change the window size for trading, isn&rsquo;t possible. We can fix that though by using closures. We just need to wrap the functions we are passing in closures (or all of them) that take in some parameter, adjust the function to use the parameter, and return the function as a result:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Changing the should_buy_avg and should_sell_minmax functions.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_buy_avg_closure</span>(window_size: int) <span style="color:#f92672">-&gt;</span> TradingStrategyFunction:  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_buy_avg</span>(prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>        list_window <span style="color:#f92672">=</span> prices[<span style="color:#f92672">-</span>window_size:]  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span> statistics<span style="color:#f92672">.</span>mean(list_window)  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> should_buy_avg
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_sell_minmax_closure</span>(max_price: int) <span style="color:#f92672">-&gt;</span> TradingStrategyFunction:  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_sell_minmax</span>(prices: list[int]) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># sell if it&#39;s above $33,000  </span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&gt;</span> max_price  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> should_sell_minmax
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Changing the call in main.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>() <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Creates the exchange and connects to it  </span>
</span></span><span style="display:flex;"><span>    exchange <span style="color:#f92672">=</span> Exchange()  
</span></span><span style="display:flex;"><span>    exchange<span style="color:#f92672">.</span>connect()  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># create the trading bot and run the bot once  </span>
</span></span><span style="display:flex;"><span>    bot <span style="color:#f92672">=</span> TradingBot(exchange, should_buy_avg_closure(<span style="color:#ae81ff">4</span>), should_sell_minmax_closure(<span style="color:#ae81ff">35_000_00</span>))  
</span></span><span style="display:flex;"><span>    bot<span style="color:#f92672">.</span>run(<span style="color:#e6db74">&#39;BTC/USD&#39;</span>)
</span></span></code></pre></div><p>This alleviates our issue, but is not very elegant looking and a bit verbose. To avoid that route, we can use partial functions.</p>
<p>A partial function application fixes a number of arguments in the original function and returns a new function without those arguments. Different from querying. It allows us to bypass the <code>TradingStrategyFunction()</code> callable without having a type error, since we want to pass in some parameter.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Using a video (https://www.youtube.com/watch?v=ph2HjBQuI8Y&amp;list=PLU-P2PlzpIf3EpWfxk-Mu_ZVJVS5Wb-_e&amp;index=35)  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">to follow along and learn some neat things functions can do  
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> statistics  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dataclasses <span style="color:#f92672">import</span> dataclass  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> typing <span style="color:#f92672">import</span> Callable, Protocol  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> exchange <span style="color:#f92672">import</span> Exchange  
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> partial  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>TradingStrategyFunction <span style="color:#f92672">=</span> Callable[list[int], bool]  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_buy_avg</span>(prices: list[int], window_size: int) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>    list_window <span style="color:#f92672">=</span> prices[<span style="color:#f92672">-</span>window_size:]  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span> statistics<span style="color:#f92672">.</span>mean(list_window)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_sell_avg</span>(prices: list[int], window_size: int) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>    list_window <span style="color:#f92672">=</span> prices[<span style="color:#f92672">-</span>window_size:]  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&gt;</span> statistics<span style="color:#f92672">.</span>mean(list_window)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_buy_minmax</span>(prices: list[int], min_price: int) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;</span> min_price  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">should_sell_minmax</span>(prices: list[int], max_price: int) <span style="color:#f92672">-&gt;</span> bool:  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> prices[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">&gt;</span> max_price  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TradingBot</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;Trading bot that connects to a crypto exchange and performs trades.&#34;&#34;&#34;</span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    exchange: Exchange  
</span></span><span style="display:flex;"><span>    buy_strategy: TradingStrategyFunction  
</span></span><span style="display:flex;"><span>    sell_strategy: TradingStrategyFunction  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">run</span>(self, symbol: str) <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>        prices <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>exchange<span style="color:#f92672">.</span>get_market_data(symbol)  
</span></span><span style="display:flex;"><span>        should_buy <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>buy_strategy(prices)  
</span></span><span style="display:flex;"><span>        should_sell <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>sell_strategy(prices)  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> should_buy:  
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>exchange<span style="color:#f92672">.</span>buy(symbol, <span style="color:#ae81ff">10</span>)  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> should_sell:  
</span></span><span style="display:flex;"><span>            self<span style="color:#f92672">.</span>exchange<span style="color:#f92672">.</span>sell(symbol, <span style="color:#ae81ff">10</span>)  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:  
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;No action required for </span><span style="color:#e6db74">{</span>symbol<span style="color:#e6db74">}</span><span style="color:#e6db74">.&#39;</span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>() <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">None</span>:  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Creates the exchange and connects to it  </span>
</span></span><span style="display:flex;"><span>    exchange <span style="color:#f92672">=</span> Exchange()  
</span></span><span style="display:flex;"><span>    exchange<span style="color:#f92672">.</span>connect()  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># create the trading bot and run the bot once  </span>
</span></span><span style="display:flex;"><span>    buy_strategy <span style="color:#f92672">=</span> partial(should_buy_avg, window_size<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span>)  
</span></span><span style="display:flex;"><span>    sell_strategy <span style="color:#f92672">=</span> partial(should_sell_minmax, max_price<span style="color:#f92672">=</span><span style="color:#ae81ff">35_000_00</span>)  
</span></span><span style="display:flex;"><span>    bot <span style="color:#f92672">=</span> TradingBot(exchange, buy_strategy, sell_strategy)  
</span></span><span style="display:flex;"><span>    bot<span style="color:#f92672">.</span>run(<span style="color:#e6db74">&#39;BTC/USD&#39;</span>)  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;__main__&#39;</span>:  
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div>
            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://mrpointing.com/tags/computerscience/">computerscience</a></span>
        <span class="tag"><a href="https://mrpointing.com/tags/youtube/">youtube</a></span>
        <span class="tag"><a href="https://mrpointing.com/tags/python/">python</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content" style=>
            
            <a href="https://mrpointing.com" style="text-decoration: none;">Richard Pointing</a>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            
            
        </div>
    </div>
    
    

<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<script src="/pagefind/pagefind-ui.js"></script>
<div id="search"></div>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true });
    });
</script>
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js" integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc&#43;cxaJzDdCYbAW0X1G&#43;DgZYvtKFXe6MBex8jUJ2JT25mQx&#43;YjACIng=="></script>




    </body>
</html>
