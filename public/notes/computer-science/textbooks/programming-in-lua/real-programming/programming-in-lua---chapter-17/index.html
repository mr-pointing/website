<!DOCTYPE html>
<html lang="en">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content=" Modules and Packages When it comes to Lua, there are generally no policies set in place. However, starting with Lua 5.1, there are policies set up for modules and packages. Programmers are open to follow these policies or define their own as they see fit. We consider a module as some code in Lua or C, and can be loaded into an environment using the function require that creates and returns a table. All things defined (variables, functions, etc.) are defined in the table provided.
" />
<meta name="keywords" content="homepage, blog, computerscience, textbook, lua" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="http://localhost:1313/notes/computer-science/textbooks/programming-in-lua/real-programming/programming-in-lua---chapter-17/" />


    <title>
        
            Programming in Lua - Chapter 17 :: Mr. Pointing  â€” Computer Science Teacher
        
    </title>








<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Programming in Lua - Chapter 17">
  <meta itemprop="description" content="Modules and Packages When it comes to Lua, there are generally no policies set in place. However, starting with Lua 5.1, there are policies set up for modules and packages. Programmers are open to follow these policies or define their own as they see fit. We consider a module as some code in Lua or C, and can be loaded into an environment using the function require that creates and returns a table. All things defined (variables, functions, etc.) are defined in the table provided.">
  <meta itemprop="datePublished" content="2025-05-19T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-05-19T00:00:00+00:00">
  <meta itemprop="wordCount" content="652">
  <meta itemprop="image" content="http://localhost:1313/">
  <meta itemprop="keywords" content="Computerscience,Textbook,Lua">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/">
  <meta name="twitter:title" content="Programming in Lua - Chapter 17">
  <meta name="twitter:description" content="Modules and Packages When it comes to Lua, there are generally no policies set in place. However, starting with Lua 5.1, there are policies set up for modules and packages. Programmers are open to follow these policies or define their own as they see fit. We consider a module as some code in Lua or C, and can be loaded into an environment using the function require that creates and returns a table. All things defined (variables, functions, etc.) are defined in the table provided.">



    <meta property="og:url" content="http://localhost:1313/notes/computer-science/textbooks/programming-in-lua/real-programming/programming-in-lua---chapter-17/">
  <meta property="og:site_name" content="Mr. Pointing">
  <meta property="og:title" content="Programming in Lua - Chapter 17">
  <meta property="og:description" content="Modules and Packages When it comes to Lua, there are generally no policies set in place. However, starting with Lua 5.1, there are policies set up for modules and packages. Programmers are open to follow these policies or define their own as they see fit. We consider a module as some code in Lua or C, and can be loaded into an environment using the function require that creates and returns a table. All things defined (variables, functions, etc.) are defined in the table provided.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="notes">
    <meta property="article:published_time" content="2025-05-19T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-05-19T00:00:00+00:00">
    <meta property="article:tag" content="Computerscience">
    <meta property="article:tag" content="Textbook">
    <meta property="article:tag" content="Lua">
    <meta property="og:image" content="http://localhost:1313/">






    <meta property="article:published_time" content="2025-05-19 00:00:00 &#43;0000 UTC" />









    



    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">

    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                mr. pointing</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">About</a></li><li><a href="/notes">Notes</a></li><li><a href="/now">Now</a></li><li><a href="/posts">Posts</a></li><li><a href="/projects">Projects</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="http://localhost:1313/notes/computer-science/textbooks/programming-in-lua/real-programming/programming-in-lua---chapter-17/">Programming in Lua - Chapter 17</a></h2>

            
            
            

            <div class="post-content">
                <hr>
<h1 id="modules-and-packages">Modules and Packages</h1>
<p>When it comes to Lua, there are generally no policies set in place. However, starting with Lua 5.1, there are policies set up for modules and packages. Programmers are open to follow these policies or define their own as they see fit. We consider a <em>module</em> as some code in Lua or C, and can be loaded into an environment using the function <code>require</code> that creates and returns a table. All things defined (variables, functions, etc.) are defined in the table provided.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> mod <span style="color:#f92672">=</span> require <span style="color:#e6db74">&#34;mod&#34;</span>
</span></span><span style="display:flex;"><span>mod.foo()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">#</span> another way...
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> m <span style="color:#f92672">=</span> require <span style="color:#e6db74">&#34;mod&#34;</span>
</span></span><span style="display:flex;"><span>m.foo()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">#</span> another other way...
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> m <span style="color:#f92672">=</span> require <span style="color:#e6db74">&#34;mod&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> f <span style="color:#f92672">=</span> m.foo
</span></span><span style="display:flex;"><span>f()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">#</span> another other OTHER way...
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> f <span style="color:#f92672">=</span> require <span style="color:#e6db74">&#34;mod&#34;</span>.foo
</span></span><span style="display:flex;"><span>f()
</span></span></code></pre></div><p>Each example has the same element in common, <code>require</code>.</p>
<h2 id="the-function-require">The Function <code>require</code></h2>
<p>We&rsquo;ve seen many times how extensible Lua is; the <code>require</code> function is no different. It acts like any regular Lua function, and has minimal assumptions as to what actually defines a module. Essentially, any chunk that defines some variables is enough.</p>
<p>The first thing <code>require</code> will do is check a table called <code>package.loaded</code> to see if the package is already in. If it is, <code>require</code> returns whatever value(s) associated. If it isn&rsquo;t in the table, Lua will search for a Lua file of the same name in <code>package.path</code>, something we&rsquo;ll return too later. If that file is found, the function <code>loadfile</code> is called and creates a function called a <em>loader</em>. Simple; a loader loads a module/package.</p>
<p>To actually do the loading of said file, we need to call the loader with two arguments; the module name and the name of the file where it got the loader. If anything gets returned, <code>require</code> sends the value back and stores it inside that <code>package.loaded</code> table we mentioned previously. If no value is returned from the loader, the table entry for <code>package.loaded[modname]</code> is empty, <code>require</code> will just send back <code>true</code>.</p>
<h3 id="path-searching">Path Searching</h3>
<p>The way Lua uses paths is quite odd. ISO C (how Lua runs) does not have a traditional directory. Instead, the path used by functions like <code>require</code>, use a list of templates that can transform a module name (which is passed when using <code>require</code>) into a filename. Weird, so let&rsquo;s look at an example. If we wanted to call <code>require('sql')</code>, our path might look like this; <code>?;?.lua;c:\windows\?;/usr/local/lua/?/?.lua</code>, will try to open the following files;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span>sql
</span></span><span style="display:flex;"><span>sql.lua
</span></span><span style="display:flex;"><span>c:<span style="color:#960050;background-color:#1e0010">\</span>windows<span style="color:#960050;background-color:#1e0010">\</span>sql
</span></span><span style="display:flex;"><span><span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span><span style="color:#66d9ef">local</span><span style="color:#f92672">/</span>lua<span style="color:#f92672">/</span>sql<span style="color:#f92672">/</span>sql.lua
</span></span></code></pre></div><p>By default, the path used by <code>require</code> is the current value of <code>package.path</code>. This is set up when the module <code>package</code> is initialized, with the default value being the environment variable <code>LUA_PATH_5_3;</code>.</p>
<h3 id="searchers">Searchers</h3>
<p><code>require</code> is, admittidly, a lot more complex than I or the text have attempted to convey. There is a lot of abstraction happening the user doesn&rsquo;t need to be privy too. Except we&rsquo;re learners, and we should (at least) try to understand what&rsquo;s going on.</p>
<p>What we&rsquo;re actually doing when using <code>require</code> is calling <em>searcher</em> function to take the module name and return a loader if it&rsquo;s found, or a <code>nil</code> if it can&rsquo;t. You can check out what searchers are being used by calling the table <code>package.loaders</code>.</p>
<h2 id="the-basic-approach-to-writing-modules-in-lua">The Basic Approach to Writing Modules in Lua</h2>
<p>Lua loves simple; just create a table, add in some values or functions, and return it. Most files you&rsquo;ll see simply start with,</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;</span>some luaisms...<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You could also define all functions as locals and build the returning table at the end, like in the following example;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">new</span> (r, i) <span style="color:#66d9ef">return</span> {r<span style="color:#f92672">=</span>r, i<span style="color:#f92672">=</span>i} <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- defines constant &#39;i&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> i <span style="color:#f92672">=</span> complex.new(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>other functions<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>  new <span style="color:#f92672">=</span> new,
</span></span><span style="display:flex;"><span>  i <span style="color:#f92672">=</span> i,
</span></span><span style="display:flex;"><span>  add <span style="color:#f92672">=</span> add,
</span></span><span style="display:flex;"><span>  sub <span style="color:#f92672">=</span> sub,
</span></span><span style="display:flex;"><span>  mul <span style="color:#f92672">=</span> mul,
</span></span><span style="display:flex;"><span>  div <span style="color:#f92672">=</span> div,
</span></span><span style="display:flex;"><span>  tostring <span style="color:#f92672">=</span> tostring,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="exercises">Exercises</h3>
<ol>
<li>Rewrite the implementation of a double-ended queues (Listing 14.2) as a proper module</li>
<li>Rewrite the geometric-region system (9.4) as a proper module.</li>
</ol>
<hr>
<p>Next:
<a href="http://localhost:1313/notes/computer-science/textbooks/programming-in-lua/lua-isms/programming-in-lua---chapter-18/">Chapter 18</a></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="http://localhost:1313/tags/computerscience/">computerscience</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/textbook/">textbook</a></span>
        <span class="tag"><a href="http://localhost:1313/tags/lua/">lua</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content" style=>
            
            <a href="https://mrpointing.com" style="text-decoration: none;">Richard Pointing</a>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            
            
        </div>
    </div>
    
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js" integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc&#43;cxaJzDdCYbAW0X1G&#43;DgZYvtKFXe6MBex8jUJ2JT25mQx&#43;YjACIng=="></script>




    </body>
</html>
