<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content=" Data Files and Serialization Writing data is usually much cleaner than reading in data. There are many different ways in which the process can be corrupted. This calls for writing well written, error-preventative code. Problem is, that&rsquo;s pretty hard. We can do one better; we can make our data easier to read in by writing it in readable formats. Lua makes this easy. We can write code that will generate our data objects for us.
" />
<meta name="keywords" content="homepage, blog, computerscience, textbook, lua" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://mrpointing.com/notes/computer-science/textbooks/programming-in-lua/real-programming/programming-in-lua---chapter-15/" />


    <title>
        
            Programming in Lua - Chapter 15 :: Mr. Pointing  — Computer Science Teacher
        
    </title>





<link rel="stylesheet" href="/main.beed7ec0a4209151b286d8198a1a48ab4a049c98171a52a7fbd3f544487e9b1a.css" integrity="sha256-vu1&#43;wKQgkVGyhtgZihpIq0oEnJgXGlKn&#43;9P1REh&#43;mxo=">




<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/favicon.ico">
    <meta name="msapplication-TileColor" content="">



  <meta itemprop="name" content="Programming in Lua - Chapter 15">
  <meta itemprop="description" content="Data Files and Serialization Writing data is usually much cleaner than reading in data. There are many different ways in which the process can be corrupted. This calls for writing well written, error-preventative code. Problem is, that’s pretty hard. We can do one better; we can make our data easier to read in by writing it in readable formats. Lua makes this easy. We can write code that will generate our data objects for us.">
  <meta itemprop="datePublished" content="2025-05-04T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-05-04T00:00:00+00:00">
  <meta itemprop="wordCount" content="477">
  <meta itemprop="image" content="https://mrpointing.com/">
  <meta itemprop="keywords" content="Computerscience,Textbook,Lua">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://mrpointing.com/">
  <meta name="twitter:title" content="Programming in Lua - Chapter 15">
  <meta name="twitter:description" content="Data Files and Serialization Writing data is usually much cleaner than reading in data. There are many different ways in which the process can be corrupted. This calls for writing well written, error-preventative code. Problem is, that’s pretty hard. We can do one better; we can make our data easier to read in by writing it in readable formats. Lua makes this easy. We can write code that will generate our data objects for us.">



    <meta property="og:url" content="https://mrpointing.com/notes/computer-science/textbooks/programming-in-lua/real-programming/programming-in-lua---chapter-15/">
  <meta property="og:site_name" content="Mr. Pointing">
  <meta property="og:title" content="Programming in Lua - Chapter 15">
  <meta property="og:description" content="Data Files and Serialization Writing data is usually much cleaner than reading in data. There are many different ways in which the process can be corrupted. This calls for writing well written, error-preventative code. Problem is, that’s pretty hard. We can do one better; we can make our data easier to read in by writing it in readable formats. Lua makes this easy. We can write code that will generate our data objects for us.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="notes">
    <meta property="article:published_time" content="2025-05-04T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-05-04T00:00:00+00:00">
    <meta property="article:tag" content="Computerscience">
    <meta property="article:tag" content="Textbook">
    <meta property="article:tag" content="Lua">
    <meta property="og:image" content="https://mrpointing.com/">






    <meta property="article:published_time" content="2025-05-04 00:00:00 &#43;0000 UTC" />









    




    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">

    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text ">
                mr. pointing</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about">About</a></li><li><a href="/notes">Notes</a></li><li><a href="/now">Now</a></li><li><a href="/posts">Posts</a></li><li><a href="/projects">Projects</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://mrpointing.com/notes/computer-science/textbooks/programming-in-lua/real-programming/programming-in-lua---chapter-15/">Programming in Lua - Chapter 15</a></h2>

            
            
            

            <div class="post-content">
                <hr>
<h1 id="data-files-and-serialization">Data Files and Serialization</h1>
<p>Writing data is usually much cleaner than reading in data. There are many different ways in which the process can be corrupted. This calls for writing well written, error-preventative code. Problem is, that&rsquo;s pretty hard. We can do one better; we can make our data easier to read in by writing it in readable formats. Lua makes this easy. We can write code that will generate our data objects for us.</p>
<p>Lua has been used for <em>data description</em>, alongside languages like XML and JSON. They have their own pros and cons, but what makes Lua so strong is it&rsquo;s ease to write and read. Lua runs and compiles lighting fast (reads, compiles, and runs a program with 10 million assignments within 4 seconds).</p>
<h2 id="data-files">Data Files</h2>
<p>we&rsquo;ll come back later to using other people&rsquo;s data later. If we are creating our own data, we can write our data out using Lua constructors.</p>
<p>If we had the following CSV file;</p>
<pre tabindex="0"><code class="language-csv" data-lang="csv">Thus Spoke Zarathustra, Freidrich Neitchze, 1883, 281
Wind and Truth, Brandon Sanderson, 2024, 1329
</code></pre><p>would be written as;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span>Entry{
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Thus Spoke Zarathustra&#34;</span>, <span style="color:#e6db74">&#34;Freidrich Neitchze&#34;</span>, <span style="color:#ae81ff">1883</span>, <span style="color:#ae81ff">281</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Entry{
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;Wind and Truth&#34;</span>, <span style="color:#e6db74">&#34;Brandon Sanderson&#34;</span>, <span style="color:#ae81ff">2024</span>, <span style="color:#ae81ff">1329</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, if we write a file that runs this with a proper definition for <code>Entry</code> we can count the number of entries if we call this file <code>data</code>;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">local</span> count <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Entry</span>() count <span style="color:#f92672">=</span> count <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>dofile(<span style="color:#e6db74">&#34;data&#34;</span>)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Number of entries: &#34;</span> <span style="color:#f92672">..</span> count)
</span></span></code></pre></div><p>Remember, <code>dofile</code> opens and runs the program, calling each <code>Entry</code> and performing the according function.</p>
<p>If the file size being large isn&rsquo;t a problem for you, you could also use key-value pair system of naming each attribute, called <em>self-describing data</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#75715e">-- data.lua</span>
</span></span><span style="display:flex;"><span>Entry{
</span></span><span style="display:flex;"><span>  name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;The Secret History&#34;</span>,
</span></span><span style="display:flex;"><span>  author<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Donna Tart&#34;</span>,
</span></span><span style="display:flex;"><span>  year<span style="color:#f92672">=</span><span style="color:#ae81ff">1992</span>,
</span></span><span style="display:flex;"><span>  pages<span style="color:#f92672">=</span><span style="color:#ae81ff">572</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">-- collect authors</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">local</span> authors <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Entry</span> (b) authors[b.author <span style="color:#f92672">or</span> <span style="color:#e6db74">&#34;unknown&#34;</span>] <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span> <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>dofile(<span style="color:#e6db74">&#39;data&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> name <span style="color:#66d9ef">in</span> pairs(authors) <span style="color:#66d9ef">do</span> print(name) <span style="color:#66d9ef">end</span>
</span></span></code></pre></div><h2 id="serialization">Serialization</h2>
<p>Serialization is the process of converting some data into a stream of bytes or characters to either save or send it somewhere. The following will reconstruct saved values into whatever given program you desire;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">serialize</span> (o)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">local</span> t <span style="color:#f92672">=</span> type(o)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> t <span style="color:#f92672">&lt;</span>mark<span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#34;number&#34;</span> <span style="color:#f92672">or</span> t <span style="color:#f92672">&lt;/</span>mark<span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#34;string&#34;</span> <span style="color:#f92672">or</span> t <span style="color:#f92672">&lt;</span>mark<span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#34;boolean&#34;</span> <span style="color:#f92672">or</span> t <span style="color:#f92672">&lt;/</span>mark<span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#34;nil&#34;</span> <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    io.write(string.format(<span style="color:#e6db74">&#34;%q&#34;</span>, o))
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> <span style="color:#f92672">&lt;</span>other cases<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>Our objective here is to save our data. For tables, which are harder, come in different forms depending on the type. For tables without cycles;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-lua" data-lang="lua"><span style="display:flex;"><span>  <span style="color:#66d9ef">local</span> t <span style="color:#f92672">=</span> type(o)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> t <span style="color:#f92672">&lt;</span>mark<span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#34;number&#34;</span> <span style="color:#f92672">or</span> t <span style="color:#f92672">&lt;/</span>mark<span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#34;string&#34;</span> <span style="color:#f92672">or</span> t <span style="color:#f92672">&lt;</span>mark<span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#34;boolean&#34;</span> <span style="color:#f92672">or</span> t <span style="color:#f92672">&lt;/</span>mark<span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#34;nil&#34;</span> <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    io.write(string.format(<span style="color:#e6db74">&#34;%q&#34;</span>, o))
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> t <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;table&#34;</span>:
</span></span><span style="display:flex;"><span>    io.write(<span style="color:#e6db74">&#34;{</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> k, v <span style="color:#66d9ef">in</span> pairs(o) <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>      io.write(string.format(<span style="color:#e6db74">&#34; [%s] = &#34;</span>, serialize(k)))
</span></span><span style="display:flex;"><span>      serialize(v)
</span></span><span style="display:flex;"><span>      io.write(<span style="color:#e6db74">&#34;,</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span>    io.write(<span style="color:#e6db74">&#34;}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    error(<span style="color:#e6db74">&#34;cannot serialize a &#34;</span> <span style="color:#f92672">..</span> type(o))
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">end</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><h3 id="exercises">Exercises</h3>
<ol>
<li>Modify the above code so that it indents nested tables</li>
</ol>
<hr>
<p>Next:
<a href="https://mrpointing.com/notes/computer-science/textbooks/programming-in-lua/real-programming/programming-in-lua---chapter-16/">Chapter 16</a></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://mrpointing.com/tags/computerscience/">computerscience</a></span>
        <span class="tag"><a href="https://mrpointing.com/tags/textbook/">textbook</a></span>
        <span class="tag"><a href="https://mrpointing.com/tags/lua/">lua</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content" style=>
            
            <a href="https://mrpointing.com" style="text-decoration: none;">Richard Pointing</a>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            
            
        </div>
    </div>
    
    

<link href="/pagefind/pagefind-ui.css" rel="stylesheet">
<script src="/pagefind/pagefind-ui.js"></script>
<div id="search"></div>
<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#search", showSubResults: true, resetStyles: true });
    });
</script>
</footer>

            
        </div>

        



<script type="text/javascript" src="/bundle.min.e89fda0f29b95d33f6f4224dd9e5cf69d84aff3818be2b0d73e731689cc374261b016d17d46f8381962fb4a1577ba3017b1f23509d894f6e66431f988c00889e.js" integrity="sha512-6J/aDym5XTP29CJN2eXPadhK/zgYvisNc&#43;cxaJzDdCYbAW0X1G&#43;DgZYvtKFXe6MBex8jUJ2JT25mQx&#43;YjACIng=="></script>




    </body>
</html>
